# 浏览器缓存

## Web 缓存的介绍

- Web 缓存是指一个 Web 资源（如 html 页面、图片、JS、数据等）存在于 Web 服务器和客户端（浏览器）之间的副本
- 缓存会根据进来的请求保存输出内容的副本；当下一个请求来到的时候，如果是相同的 URL，缓存会根据缓存机制决定是直接使用副本响应访问请求，还是向源服务器再次发送请求

## Web 缓存的好处

- 减少网络延迟，加快页面打开速度
- 减少网络带宽消耗
- 降低服务器压力

## HTTP 的缓存机制

### 分局什么规则缓存

- 1. 新鲜度（过期机制）：也就是缓存副本有效期。一个缓存副本必须满足以下条件，浏览器会认为它是有效的，足够新的
  - 含有完整的过期时间控制头信息（HTTP 协议报头，并且仍在有效期内）
  - 浏览器已经使用过这个缓存副本，并且在一个会话中已经检查过新鲜度
- 2. 校验机制（验证机制）：服务器返回资源的时候有时在控制头信息带上这个资源的实体标签 ETag ，他可以用来作为浏览器再次请求过程的校验标识。如果发现校验标识不匹配，说明资源已经被修改或过期，浏览器需重新获取资源内容。

### HTTP 缓存的两个阶段

浏览器缓存一般分为两类：强缓存（本地缓存）和协商缓存（弱缓存）

- 本地缓存
  - 浏览器发送请求前，会先去缓存里查看是否命中强缓存，如果命中，则直接从缓存中读取资源，不会发送请求到服务器，否则，进入下一步
- 协商缓存
  - 当强缓存没有命中时，浏览器一定会向服务器发送请求。服务器会根据 Request Header 中的一些字段来判断是否命中协商缓存。如果命中，服务器会返回 304 响应，但是不会携带任何响应实体，只是告诉浏览器可以直接从浏览器缓存中获取这个资源。如果本地缓存和协商缓存都没有命中，则从服务器加载资源
- 启用、关闭缓存
  - 协商缓存阶段
    - `Last-Modified & If-Modified-Since`
    - `ETag & If-None-Match`
  - 本地缓存阶段
    - `Cache-control`
    - `Expires`

## IndexDB

## Service Worker

## LocalStorage

## SessionStorage
